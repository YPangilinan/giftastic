<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gif-Tastic!</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>

</head>
<body>
<!-----------HTML--------------->
<div class="container">
    <div class="row">
        <div class="buttons"></div>
    </div>
    <div class="row">
        <div class="col-lg-10">
            <div id="gifs-go-here"></div>
        </div>
        <div class="col-lg-2">
            <form id="add-subject">	

                <label for="subject-input" class="input">ADD YOUR OWN: </label>
                <input type="text" id="input"><br>

                <input id="add-subject" type="submit" value="Submit">

        </div>
    </div>


</div>


<!------JAVASCRIPT---------->
    
    <script type="text/javascript">
    $(document).ready(function() {


    var topics = ["science","corgi", "weights", "tulips", "disneyland", "simba"];
    var results;

    function createButtons(){
        $(".buttons").empty();

        for (var i=0; i<topics.length; i++){
            var a = $("<button>");
            a.addClass("subject");
            a.attr("data-topic", topics[i]);
            a.text(topics[i]);
            $(".buttons").append(a);        
        };
    };

    $("#add-subject").on("click", function(event){

        event.preventDefault();

        var newSubject = $("#input").val().trim();

        topics.push(newSubject);

        createButtons();
        console.log(topics);
       

    });


    createButtons();


    function displayGif(){

        var subject = $(this).attr("data-topic");
        var queryURL = "https://api.giphy.com/v1/gifs/search?q=" +
        subject + "&api_key=jYUXFR4smqls1PsJGd9uX9MCg8qqoE0N&limit=10";
   
    //initiate ajax call within function 

    $.ajax({
        url: queryURL,
        method: "GET"
    }).then(function(response){
        console.log(response);


        results = response.data;

        $("#gifs-go-here").empty();

        for (var i=0; i< results.length; i++){

            var topicDiv = $("<div>");
            var p = $("<p>");
             p.text("Rating: " + results[i].rating);

        var topicImage = $("<img>");
        topicImage.attr("src", results[i].images.fixed_height_still.url);
        topicImage.attr("data-still", results[i].images.fixed_height_still.url);
    	topicImage.attr("data-animate", results[i].images.fixed_height.url);
        topicImage.attr("data-state", "still");
        topicImage.addClass("gif-results");

        topicDiv.append(p)
        topicDiv.append(topicImage);
        topicDiv.addClass("gifs");

        $("#gifs-go-here").prepend(topicDiv);
    
        };
    });
};

$(document).on("click", ".subject",displayGif);


$(document).on("click", ".gif-results", function(){
        var state = $(this).attr("data-state");

        
        if (state === "still") {
        $(this).attr("src", $(this).attr("data-animate"));
        $(this).attr("data-state", "animate");
      } else {
        $(this).attr("src", $(this).attr("data-still"));
        $(this).attr("data-state", "still");

      }
    }); 
    

    });


</script>
<script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js" integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6" crossorigin="anonymous"></script>
    
</body>
</html>